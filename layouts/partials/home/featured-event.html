{{ with site.GetPage "/events" }}
  {{/* Find next upcoming featured event */}}
  {{ range sort .Params.events "date" "asc" }}
    {{ with .date }}
      {{/* Skip events in the past */}}
      {{ if gt (now.Format "2006-01-02") (time.Format "2006-01-02" .) }}
        {{ continue }}
      {{ end }}
    {{ end }}
    {{ if eq .featured true }}
      {{ if .custom_layout }}
        {{/* Render custom layout */}}
        {{ partial .custom_layout . }}
      {{ else }}
        {{/* Render standard layout */}}
        <div class="featured-event animate">
          <div class="body">
            <h2>
              {{ .title }}
            </h2>
            {{ if .date }}
              <hr>
              <h3>
                {{ with .date }}
                  {{ time.Format ":date_full" . }}
                {{ end }}
                {{ if and .date .time }}
                  at 
                {{ end }}
                {{ with .time }}
                  {{ . }}
                {{ end }}
              </h3>
              {{ with .location }}
                <h4>
                  {{ . }}
                </h4>
              {{ end }}
            {{ end }}
            {{ with .content }}
              <div class="content">
                {{ . | page.RenderString (dict "display" "block") }}
              </div>
            {{ end }}
          </div>
        </div>
      {{ end }}
      {{ break }}
    {{ end }}
  {{ end }}
{{ end }}
